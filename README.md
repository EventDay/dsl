#EventDay DSL

A handy DSL for creating Akka actor protocols.

Heavily influenced by the Lokad DSL
##Installation
- Compile
- Install `EventDayDsl.vsix` in `EventDayDsl\bin\Debug`

##Features
###DDD/CQRS
```
import EventDay.Messages;
namespace EventDay.Domain.Event;

	commands	are IEventCommand;
	events		are IEvent;
    
	state DocumentState
    
	const eventId       is Guid;
	const documentId    is Guid;
    const name          is string;
    const content       is string;

    command CreateDocument(eventId, name, content)
        event DocumentCreated(eventId, documentId, name, content)
            tell DocumentState 
            
    command ChangeDocument(eventId, documentId, name, content)
        event DocumentChanged(eventId, documentId, name, content)
            tell DocumentState 
            
    command RemoveDocument(eventId, documentId)
        event DocumentRemoved(eventId, documentId)
            tell DocumentState 
```

###Immutable Messages by default
`Message(parameter1, parameter2, etc.)`

###Mutable Messages can be generated too
`entity MyEntity(string parameter1, string parameter2, etc.)`
will generate

```
	public MyEntity(parameter1 = default(String), parameter2 = default(String)){
		
	}
```
###Optional parameters
`Message(parameter1, parameter2, parameter3?)`

##Example
Demo.dsl

```

	import EventDay.Domain;
	
	namespace EventDay.Services.Indexing.Demo;
	
		const accountId     is Guid;
		const userId        is string;
		const accountName   is string;
		
		state Index:IIndexStore
	
		entity AccountAbstract(accountId, accountName, userId)
		
		//Actions
		StoreAccount(AccountAbstract accountAbstract)
			tell Index
		
		UpdateAccount(AccountAbstract accountAbstract)
			tell Index
		    
		//Queries		
		GetAccountUsers(accountId)
			tell Index
		
		GetUserAccounts(userId) 
			tell Index

```

will generate the following files nested under the DSL file:

- DemoEntities.cs
```
//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//     Runtime Version:4.0.30319.42000
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

using Akka;
using EventDay.Domain;
using Newtonsoft.Json;
using System;
using System.Collections.Generic;


namespace EventDay.Services.Indexing.Demo.Entities
{
    
    public class AccountAbstract
    {
		public Guid AccountId { get; set; }
		public String AccountName { get; set; }
		public String UserId { get; set; }

    }
}

```
- DemoMessages.cs
```
//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//     Runtime Version:4.0.30319.42000
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

using Akka;
using EventDay.Domain;
using Newtonsoft.Json;
using System;
using System.Collections.Generic;


namespace EventDay.Services.Indexing.Demo.Messages
{
    using EventDay.Services.Indexing.Demo.Entities;
    
    public class StoreAccount
    {
        public AccountAbstract AccountAbstract { get; private set; }//;
        public StoreAccount(AccountAbstract accountAbstract)
        {
            this.AccountAbstract = accountAbstract;
        }
        public virtual StoreAccount SetProperties(AccountAbstract accountAbstract = default(AccountAbstract))
        {
            AccountAbstract localAccountAbstract = accountAbstract;
            if ((accountAbstract == default(AccountAbstract)))
            {
                localAccountAbstract = this.AccountAbstract;
            }
            return new StoreAccount(localAccountAbstract);
        }
    }
    public class UpdateAccount
    {
        public AccountAbstract AccountAbstract { get; private set; }//;
        public UpdateAccount(AccountAbstract accountAbstract)
        {
            this.AccountAbstract = accountAbstract;
        }
        public virtual UpdateAccount SetProperties(AccountAbstract accountAbstract = default(AccountAbstract))
        {
            AccountAbstract localAccountAbstract = accountAbstract;
            if ((accountAbstract == default(AccountAbstract)))
            {
                localAccountAbstract = this.AccountAbstract;
            }
            return new UpdateAccount(localAccountAbstract);
        }
    }
    public class GetAccountUsers
    {
        public Guid AccountId { get; private set; }//;
        public GetAccountUsers(Guid accountId)
        {
            this.AccountId = accountId;
        }
        public virtual GetAccountUsers SetProperties(Guid accountId = default(Guid))
        {
            Guid localAccountId = accountId;
            if ((accountId == default(Guid)))
            {
                localAccountId = this.AccountId;
            }
            return new GetAccountUsers(localAccountId);
        }
    }
    public class GetUserAccounts
    {
        public String UserId { get; private set; }//;
        public GetUserAccounts(String userId)
        {
            this.UserId = userId;
        }
        public virtual GetUserAccounts SetProperties(String userId = default(String))
        {
            String localUserId = userId;
            if ((userId == default(String)))
            {
                localUserId = this.UserId;
            }
            return new GetUserAccounts(localUserId);
        }
    }
}

```

- DemoStateSubscriptions.cs
```
//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//     Runtime Version:4.0.30319.42000
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

using Akka;
using EventDay.Domain;
using Newtonsoft.Json;
using System;
using System.Collections.Generic;


namespace EventDay.Services.Indexing.Demo.State
{
    using EventDay.Services.Indexing.Demo.Messages;
    
    public interface IIndexStore
    {
        void When(StoreAccount message);
        void When(UpdateAccount message);
        void When(GetAccountUsers message);
        void When(GetUserAccounts message);
    }
    public abstract class IndexSubscription : IStateHandler, IIndexStore
    {
        public virtual bool Receive(object message)
        {
            return message.Match().With<StoreAccount>(When).With<UpdateAccount>(When).With<GetAccountUsers>(When).With<GetUserAccounts>(When).WasHandled;
        }
        public abstract void When(StoreAccount message);
        public abstract void When(UpdateAccount message);
        public abstract void When(GetAccountUsers message);
        public abstract void When(GetUserAccounts message);
    }
}

```
##Simple Demo
```
using Akka.Actor;

using EventDay.Services.Indexing.Demo.Messages;
using EventDay.Services.Indexing.Demo.State;

namespace EventDay.Services.Indexing.Demo
{
    public class DemoActor : ActorBase    {
        private readonly MessageSubscrition _subscrition;

        public DemoActor(IIndexStore store)
        {
            _subscrition = new MessageSubscrition(store);
        }

        protected override bool Receive(object message)
        {
            return _subscrition.Receive(message);
        }
    }

    class MessageSubscrition : IndexSubscription {
        private readonly IIndexStore _store;

        public MessageSubscrition(IIndexStore store)
        {
            _store = store;
        }

        public override void When(StoreAccount message)
        {
            _store.When(message);
        }

        public override void When(UpdateAccount message)
        {
            _store.When(message);
        }

        public override void When(GetAccountUsers message)
        {
            _store.When(message);
        }

        public override void When(GetUserAccounts message)
        {
            _store.When(message);
        }
    }


    public class DemoStore : IIndexStore
    {
        public void When(StoreAccount message)
        {
            throw new System.NotImplementedException();
        }

        public void When(UpdateAccount message)
        {
            throw new System.NotImplementedException();
        }

        public void When(GetAccountUsers message)
        {
            throw new System.NotImplementedException();
        }

        public void When(GetUserAccounts message)
        {
            throw new System.NotImplementedException();
        }
    }
}
```


